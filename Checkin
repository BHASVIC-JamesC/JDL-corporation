#include <stdio.h>
#include <time.h>
#include <stdlib.h>
#include <string.h>
int checkIn(g);

char personalDetails[4][12][24];
int guest = 0;
char   firstName[4][20], lastName[4][20], board[4][2], newspaper[4], bookingID[4][24], temp[20], temp2[20];
int guests[4], children[4], days[4], day, month, year, daysa, age[4], room[4], valid = 0,  random;

int main(void)
{
    int data;
    char userChoice;
    printf("Welcome to Kashyyk Hotel\n");
    printf("Would you like to check in(a), Book dinner(b) or Check out(c)");
    fflush(stdin);
    scanf("%d", userChoice);
    checkIn();
    switch (userChoice) {
        case'a':
            checkIn();
            break;
        case'b':
            //dinner()
            break;
        case'c':
            //checkOut()
            break;
        default:
            for (int x = 0; x<3; x++){
                printf("What guest data do you want to see");
                fflush(stdin);
                scanf("%d", &data);
                printf("%d", data);
                for (int i = 1; i < 11; i++) {
                    printf ("%s\t", personalDetails[data][i]);
                }
            }
    }
    return 0;
}
int checkIn() {
    srand(time(NULL));
    printf("Enter your name:");
    fflush(stdin);
    scanf("%s %s", firstName[guest], lastName[guest]);
    printf("%s %s\n", firstName[guest], lastName[guest]);
    do {
        printf("What is your date of birth, enter day month then year ");

        scanf("%d %d %d", &day, &month, &year);
        printf("%d/%d/%d\n", day, month, year);
        if (year>24) {
            daysa = (14 - day) + 12*(11 - month) + 365*(24 + (100-year));
        }
        else {
            daysa = (14 - day) + 12*(11 - month) + 365*(24 - year);
        }
        age[guest] = daysa / 365;
        printf("%d", age[guest]);
    }while (age[guest] < 16);
    do {
        printf("Enter your guests:");
        fflush(stdin);
        scanf("%d", &guests[guest]);
        if (guests[guest] > 4) {
            printf("The max guests is 4. Enter again:\n");
        }
    }while (guests[guest] > 4 || guests[guest] < 0);
    do {
        printf("How many children will be staying with you:");
        fflush(stdin);
        scanf("%d", &children[guest]);
        if (children[guest] >= guests[guest]) {
            printf("Enter a valid amount of children");
        }
    }while (children[guest] > guests[guest]);
    do {
        printf("What board type do you want to book:\nFull Board(FB)\tHalf Board(HB)\tBed and Breakfast(BB)");
        fflush(stdin);
        scanf("%s", board[guest]);
        printf("%s", board[guest]);
        if(strcmp(board[guest],"FB") != 0 && strcmp(board[guest],"HB") != 0 && strcmp(board[guest],"BB") != 0 ) {
            printf("You entered an invalid board. Please try again.\n");
        }
    }while (strcmp(board[guest],"FB") != 0 && strcmp(board[guest],"HB") != 0 && strcmp(board[guest],"BB") != 0);
    do {
        printf("\nHow many days will you be staying with us:");
        fflush(stdin);
        scanf("%d", &days[guest]);
        if(days[guest] < 0) {
            printf("You entered an invalid day. Please try again.\n");
        }
    }while(days[guest] < 0);
    do {
        printf("Do you want a daily newspaper? (Y) or (N)");
        fflush(stdin);
        scanf("%c", &newspaper[guest]);
        if (newspaper[guest] != 'Y' && newspaper[guest] != 'N') {
            printf("Enter a valid newspaper option 'Y' or 'N'");
        }
    }while (newspaper[guest] != 'Y' && newspaper[guest] != 'N');
    do {
        printf("What Room would you like to book(Prices are displayed per day):\nRoom 1(£100)\tRoom 2(£100)\tRoom 3(£85)\tRoom 4(£75)\tRoom 5(£75)\tRoom 6(£50)");
        fflush(stdin);
        scanf("%d", &room[guest]);
        if (room[guest] > 6 || room[guest] < 1) {
            printf("You entered an invalid room. Please try again.\n");
        }
        else {
            valid = 1;
        }
        for (int i = 0; i <5 ; i++) {
            if(room[guest] == room[i] && i != guest) {
                valid = 0;
                printf("Sorry that room is unavailable, please pick another\n");
                break;
            }
        }
    }while(valid == 0);
    random = 999 + rand() % (9999 - 999);
    itoa(random, temp, 10);
    strcpy(temp2, lastName[guest]);
    strcat(temp2, temp);
    strcpy(bookingID[guest], temp2);
    printf("Booking ID: %s\n", bookingID[guest]);
    strncpy(personalDetails[guest][1], firstName[guest],24);
    strncpy(personalDetails[guest][2], lastName[guest], 24);
    snprintf(personalDetails[guest][3], 24,"%d", age[guest]);
    snprintf(personalDetails[guest][4], 24, "%d", guests[guest]);
    snprintf(personalDetails[guest][5], 24, "%d", children[guest]);
    strncpy(personalDetails[guest][6], board[guest], 24);
    snprintf(personalDetails[guest][7], 24, "%d", days[guest]);
    personalDetails[guest][8][0] = newspaper[guest];
    strncpy(personalDetails[guest][9], bookingID[guest], 24);
    guest++;
    return guest, personalDetails;
}
